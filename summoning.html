<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Terraria Summoner Class Setup</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Nunito:wght@400;600;700&display=swap');
:root {
  --bg:#f0f2f5;--card:#fff;--section:#f7f8fb;--border:#e0e5ec;
  --accent:#6633dd;--gold:#c48a00;--text:#1a2233;--muted:#6b7a99;--link:#4466cc;
  --done-bg:#f0f0f0;--done-border:#c8c8d0;--owned:#6633dd;--skip:#cc3333;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Nunito',sans-serif;background:var(--bg);color:var(--text);min-height:100vh}
header{background:#fff;padding:32px 24px 24px;border-bottom:2px solid var(--border)}
header h1{font-family:'Cinzel',serif;font-size:26px;letter-spacing:1px;color:var(--text)}
header p{margin-top:6px;color:var(--muted);font-size:14px;font-weight:600}
.container{max-width:100%;margin:auto;padding:24px 20px 48px}

.stage{background:var(--card);border-radius:14px;margin:20px 0;border:1.5px solid var(--border);overflow:hidden;transition:border-color .2s,box-shadow .2s}
.stage:hover{border-color:rgba(102,51,221,.3);box-shadow:0 4px 20px rgba(102,51,221,.07)}
.stage.done{background:var(--done-bg);border-color:var(--done-border);box-shadow:none}
.stage.done:hover{border-color:#aaaabc;box-shadow:none}

.stage-header{padding:13px 20px;background:#f4f1ff;display:flex;align-items:center;gap:10px;border-bottom:1.5px solid var(--border);cursor:pointer;user-select:none;transition:background .2s;-webkit-tap-highlight-color:transparent}
.stage-header:hover{background:#ede9ff}
.stage.done .stage-header{background:#e8e8ee;border-bottom-color:transparent}
.stage.done .stage-header:hover{background:#dddde8}
.stage-header h2{font-family:'Cinzel',serif;font-size:15px;color:var(--text);letter-spacing:.5px;flex:1;transition:color .2s}
.stage.done .stage-header h2{text-decoration:line-through;color:#999aaa}
.stage-index{width:22px;height:22px;border-radius:6px;background:var(--accent);color:#fff;font-size:11px;font-weight:700;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:background .2s;font-family:'Nunito',sans-serif}
.stage.done .stage-index{background:#aaaabc}
.stage-checkbox{appearance:none;-webkit-appearance:none;width:20px;height:20px;border-radius:5px;border:2px solid var(--accent);background:#fff;flex-shrink:0;cursor:pointer;position:relative;transition:background .15s,border-color .15s;margin-left:auto;pointer-events:none}
.stage-checkbox:checked{background:var(--accent);border-color:var(--accent)}
.stage-checkbox::after{content:'';position:absolute;top:2px;left:5px;width:6px;height:10px;border:2px solid white;border-top:none;border-left:none;transform:rotate(45deg) scale(0);transition:transform .15s}
.stage-checkbox:checked::after{transform:rotate(45deg) scale(1)}
.stage.done .stage-checkbox{border-color:#aaaabc}
.done-label{font-size:11px;font-weight:700;color:#aaaabc;letter-spacing:.5px;white-space:nowrap}
.stage-body{overflow:hidden;transition:max-height .35s cubic-bezier(.4,0,.2,1),opacity .3s ease;max-height:2000px;opacity:1}
.stage.done .stage-body{max-height:0!important;opacity:0;pointer-events:none}

.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;padding:16px}
.section{background:var(--section);border-radius:10px;padding:14px;border:1px solid var(--border)}
.section h3{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.2px;color:var(--accent);margin-bottom:10px;padding-bottom:7px;border-bottom:1px solid rgba(102,51,221,.15)}

/* Item row */
.item-wrap{display:flex;align-items:center;border-radius:6px;margin-bottom:2px;transition:background .15s;position:relative}
.item-wrap:hover{background:rgba(102,51,221,.06)}
.item{display:flex;align-items:center;gap:9px;padding:5px 8px;border-radius:6px;text-decoration:none;color:var(--link);font-size:13px;font-weight:600;line-height:1.3;transition:color .15s,transform .12s,opacity .25s;flex:1;min-width:0}
.item-wrap:hover .item{color:var(--accent);transform:translateX(3px)}
.item img{width:24px;height:24px;object-fit:contain;image-rendering:pixelated;flex-shrink:0;transition:transform .15s,filter .25s}
.item-wrap:hover .item img{transform:scale(1.2)}

/* owned state */
.item-wrap[data-state="owned"] .item{opacity:.35;text-decoration:line-through;text-decoration-color:rgba(102,51,221,.4);color:var(--muted)}
.item-wrap[data-state="owned"] .item img{filter:grayscale(60%)}
.item-wrap[data-state="owned"]:hover .item{opacity:.45;transform:none;color:var(--muted)}
.item-wrap[data-state="owned"]:hover .item img{transform:none}

/* skip state */
.item-wrap[data-state="skip"] .item{opacity:.35;text-decoration:line-through;text-decoration-color:rgba(204,51,51,.4);color:#bb7777}
.item-wrap[data-state="skip"] .item img{filter:grayscale(70%) sepia(20%)}
.item-wrap[data-state="skip"]:hover .item{opacity:.45;transform:none;color:#bb7777}
.item-wrap[data-state="skip"]:hover .item img{transform:none}

/* 3-state button */
.item-btn{
  width:18px;height:18px;border-radius:4px;
  border:1.5px solid #c5c8d8;background:#fff;
  flex-shrink:0;cursor:pointer;position:relative;
  transition:background .15s,border-color .15s,transform .12s;
  margin-right:8px;margin-left:4px;
  display:flex;align-items:center;justify-content:center;padding:0;outline:none;
}
.item-btn:hover{border-color:var(--accent);transform:scale(1.12)}

/* owned ‚Üí purple checkmark */
.item-btn[data-s="owned"]{background:var(--owned);border-color:var(--owned)}
.item-btn[data-s="owned"]::before{
  content:'';display:block;position:absolute;
  top:50%;left:50%;
  width:5px;height:9px;
  border:2px solid white;border-top:none;border-left:none;
  transform:translate(-60%, -60%) rotate(45deg);
}

/* skip ‚Üí red X */
.item-btn[data-s="skip"]{background:var(--skip);border-color:var(--skip)}
.item-btn[data-s="skip"]::before,
.item-btn[data-s="skip"]::after{
  content:'';display:block;position:absolute;
  width:10px;height:2px;background:white;border-radius:1px;
}
.item-btn[data-s="skip"]::before{transform:rotate(45deg)}
.item-btn[data-s="skip"]::after{transform:rotate(-45deg)}

/* none ‚Üí empty */
.item-btn[data-s="none"]::before,.item-btn[data-s="none"]::after{display:none}

/* ‚îÄ‚îÄ TOOLTIP POPUP ‚îÄ‚îÄ */
.tooltip-btn{
  width:16px;height:16px;border-radius:50%;
  border:1.5px solid #b0b8d0;background:#f0f2f8;
  color:#7a88aa;font-size:10px;font-weight:700;
  cursor:pointer;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  margin-left:2px;margin-right:2px;
  transition:background .15s,border-color .15s,color .15s;
  position:relative;z-index:1;
  font-family:'Nunito',sans-serif;
  padding:0;outline:none;
}
.tooltip-btn:hover{background:var(--accent);border-color:var(--accent);color:#fff}

/* Popup overlay */
.item-popup{
  display:none;
  position:fixed;
  z-index:9999;
  width:280px;
  background:#1a1d2e;
  border:1px solid rgba(102,51,221,.4);
  border-radius:12px;
  box-shadow:0 8px 32px rgba(0,0,0,.45);
  overflow:hidden;
  pointer-events:none;
}
.item-popup.visible{
  display:block;
  pointer-events:auto;
  animation:popupIn .18s cubic-bezier(.34,1.56,.64,1) both;
}
@keyframes popupIn{
  from{opacity:0;transform:scale(.88) translateY(6px)}
  to{opacity:1;transform:scale(1) translateY(0)}
}
.popup-header{
  padding:10px 12px 8px;
  background:rgba(102,51,221,.18);
  border-bottom:1px solid rgba(102,51,221,.2);
  display:flex;align-items:center;gap:8px;
}
.popup-header img{
  width:28px;height:28px;
  image-rendering:pixelated;
  object-fit:contain;
  flex-shrink:0;
}
.popup-header-name{
  font-family:'Cinzel',serif;
  font-size:12px;
  color:#e0d8ff;
  font-weight:700;
  letter-spacing:.3px;
}
.popup-close{
  margin-left:auto;
  width:20px;height:20px;
  border-radius:50%;
  border:none;
  background:rgba(255,255,255,.1);
  color:#aaa;
  font-size:13px;
  cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  flex-shrink:0;
  transition:background .15s,color .15s;
  padding:0;
}
.popup-close:hover{background:rgba(204,51,51,.5);color:#fff}
.popup-scroll{
  max-height:220px;
  overflow-y:auto;
  padding:12px;
  scrollbar-width:thin;
  scrollbar-color:rgba(102,51,221,.4) transparent;
}
.popup-scroll::-webkit-scrollbar{width:4px}
.popup-scroll::-webkit-scrollbar-track{background:transparent}
.popup-scroll::-webkit-scrollbar-thumb{background:rgba(102,51,221,.4);border-radius:2px}
.popup-section{margin-bottom:12px}
.popup-section:last-child{margin-bottom:0}
.popup-section-label{
  font-size:9.5px;font-weight:700;
  text-transform:uppercase;letter-spacing:1.2px;
  color:#7b6fb5;
  margin-bottom:4px;
  display:flex;align-items:center;gap:5px;
}
.popup-section-label .licon{font-size:11px}
.popup-section-text{
  font-size:12px;font-weight:600;
  color:#c8c0e8;
  line-height:1.55;
}
.popup-divider{
  height:1px;background:rgba(102,51,221,.15);
  margin:0 12px;
}

/* Note */
.note{margin:0 16px 16px;padding:10px 14px;background:#fffbea;border-left:3px solid var(--gold);border-radius:0 8px 8px 0;font-size:12.5px;color:#7a5c00;line-height:1.6}

/* Legend */
.legend{display:flex;gap:14px;flex-wrap:wrap;font-size:11px;font-weight:700;color:var(--muted);margin-bottom:10px;align-items:center}
.legend-item{display:flex;align-items:center;gap:5px}
.ld{width:14px;height:14px;border-radius:3px;border:1.5px solid #c5c8d8;background:#fff;flex-shrink:0}
.ld.owned{background:var(--owned);border-color:var(--owned)}
.ld.skip{background:var(--skip);border-color:var(--skip)}

/* Progress */
.progress-info{display:flex;justify-content:space-between;font-size:12px;font-weight:700;color:var(--muted);margin-bottom:8px}
.progress-info span:last-child{color:var(--accent)}

/* Summary bar */
.summary{background:#fff;border:1.5px solid var(--border);border-radius:10px;padding:10px 16px;margin-bottom:16px;font-size:12px;color:var(--muted);font-weight:600;display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.summary b{color:var(--owned)}
.summary .sc{color:var(--skip)}
.summary #ownedNames{color:#999;font-weight:400;font-size:11px;flex-basis:100%;margin-top:2px}
.reset-btn{margin-left:auto;font-size:11px;color:#cc4444;cursor:pointer;padding:3px 8px;border-radius:5px;border:1px solid #cc4444;background:none;font-family:'Nunito',sans-serif;font-weight:700;transition:background .15s,color .15s}
.reset-btn:hover{background:#cc4444;color:#fff}

footer{text-align:center;padding:24px;color:var(--muted);font-size:12px;border-top:1px solid var(--border);background:#fff}
</style>
</head>
<body>
<header>
  <div class="container" style="padding-top:0;padding-bottom:0">
    <h1>üîÆ Terraria ‚Äî Summoner Class Setup</h1>
    <p>Pre-Bosses ‚Üí Endgame ¬∑ Based on Terraria Wiki class progression</p>
  </div>
</header>

<!-- Global Popup Element (singleton) -->
<div class="item-popup" id="itemPopup">
  <div class="popup-header">
    <img id="popupImg" src="" alt="">
    <span class="popup-header-name" id="popupName"></span>
    <button class="popup-close" onclick="closePopup()">‚úï</button>
  </div>
  <div class="popup-divider"></div>
  <div class="popup-scroll">
    <div class="popup-section" id="psUnlock">
      <div class="popup-section-label"><span class="licon">üîì</span> How to Unlock</div>
      <div class="popup-section-text" id="popupUnlock"></div>
    </div>
    <div class="popup-divider" style="margin:8px 0"></div>
    <div class="popup-section" id="psGet">
      <div class="popup-section-label"><span class="licon">‚öíÔ∏è</span> How to Get</div>
      <div class="popup-section-text" id="popupGet"></div>
    </div>
    <div class="popup-divider" style="margin:8px 0"></div>
    <div class="popup-section" id="psDesc">
      <div class="popup-section-label"><span class="licon">üìñ</span> Description</div>
      <div class="popup-section-text" id="popupDesc"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="progress-info">
    <span>Stage Progress</span>
    <span id="progressText">0 / 0 completed</span>
  </div>

  <div class="legend">
    <span style="margin-right:2px">Item:</span>
    <div class="legend-item"><div class="ld"></div>Not yet</div>
    <div class="legend-item"><div class="ld owned"></div>‚úì Owned <span style="font-weight:400;color:#aaa">(Click 1√ó)</span></div>
    <div class="legend-item"><div class="ld skip"></div>‚úó Skip <span style="font-weight:400;color:#aaa">(Click 2√ó)</span></div>
    <div class="legend-item" style="color:#bbb;font-weight:400">(Click 3√ó = reset)</div>
    <div class="legend-item" style="color:#aaa;font-weight:400;margin-left:6px">¬∑ <span style="background:#1a1d2e;color:#c8c0e8;font-size:10px;padding:1px 5px;border-radius:4px;font-weight:700">‚Ñπ</span> = Info popup</div>
  </div>

  <div class="summary">
    <span>üéí Owned: <b id="ownedCount">0</b></span>
    <span>‚õî Skip: <span class="sc" id="skipCount">0</span></span>
    <span id="ownedNames">‚Äî no items marked yet</span>
    <button class="reset-btn" onclick="resetAll()">Reset everything</button>
  </div>

<!-- ‚ïê‚ïê‚ïê 1. Pre-Bosses ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-pre-bosses">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre-Bosses (King Slime) (Eye Of Cthulhu)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="leather-whip" data-state="none">
          <a class="item" href="https://terraria.wiki.gg/wiki/Leather_Whip" target="_blank"><img src="https://terraria.wiki.gg/images/Leather_Whip.png">Leather Whip</a>
          <button class="tooltip-btn" onclick="openPopup(event,'leather-whip')">‚Ñπ</button>
          <button class="item-btn" data-s="none" onclick="cycleItem(this)"></button>
        </div>
        <div class="item-wrap" data-item-id="snapthorn" data-state="none">
          <a class="item" href="https://terraria.wiki.gg/wiki/Snapthorn" target="_blank"><img src="https://terraria.wiki.gg/images/Snapthorn.png">Snapthorn</a>
          <button class="tooltip-btn" onclick="openPopup(event,'snapthorn')">‚Ñπ</button>
          <button class="item-btn" data-s="none" onclick="cycleItem(this)"></button>
        </div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <h3 style="margin-top:8px">Blood Moon Event</h3>
        <div class="item-wrap" data-item-id="vampire-frog-staff" data-state="none">
          <a class="item" href="https://terraria.wiki.gg/wiki/Vampire_Frog_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Vampire_Frog_Staff.png">Vampire Frog Staff</a>
          <button class="tooltip-btn" onclick="openPopup(event,'vampire-frog-staff')">‚Ñπ</button>
          <button class="item-btn" data-s="none" onclick="cycleItem(this)"></button>
        </div>
        <h3 style="margin-top:8px"></h3>
        <div class="item-wrap" data-item-id="abigails-flower" data-state="none">
          <a class="item" href="https://terraria.wiki.gg/wiki/Abigail%27s_Flower" target="_blank"><img src="https://terraria.wiki.gg/images/Abigail%27s_Flower.png">Abigail's Flower</a>
          <button class="tooltip-btn" onclick="openPopup(event,'abigails-flower')">‚Ñπ</button>
          <button class="item-btn" data-s="none" onclick="cycleItem(this)"></button>
        </div>
        <div class="item-wrap" data-item-id="flinx-staff" data-state="none">
          <a class="item" href="https://terraria.wiki.gg/wiki/Flinx_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Flinx_Staff.png">Flinx Staff</a>
          <button class="tooltip-btn" onclick="openPopup(event,'flinx-staff')">‚Ñπ</button>
          <button class="item-btn" data-s="none" onclick="cycleItem(this)"></button>
        </div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="flinx-fur-coat" data-state="none">
          <a class="item" href="https://terraria.wiki.gg/wiki/Flinx_Fur_Coat" target="_blank"><img src="https://terraria.wiki.gg/images/Flinx_Fur_Coat.png">Flinx Fur Coat</a>
          <button class="tooltip-btn" onclick="openPopup(event,'flinx-fur-coat')">‚Ñπ</button>
          <button class="item-btn" data-s="none" onclick="cycleItem(this)"></button>
        </div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none">
          <a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a>
          <button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button>
          <button class="item-btn" data-s="none" onclick="cycleItem(this)"></button>
        </div>
      </div>
    </div>
    <div class="note">üí° Use the best armor available for Helmet and Boots.</div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê 2. Pre EoW / BoC ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-eow-boc">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre (Eater of Worlds) (Brain of Cthulhu)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="soulscourge" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Soulscourge" target="_blank"><img src="https://terraria.wiki.gg/images/Soulscourge.png">Soulscourge</a><button class="tooltip-btn" onclick="openPopup(event,'soulscourge')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="vasculash" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Vasculash" target="_blank"><img src="https://terraria.wiki.gg/images/Vasculash.png">Vasculash</a><button class="tooltip-btn" onclick="openPopup(event,'vasculash')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="snapthorn" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Snapthorn" target="_blank"><img src="https://terraria.wiki.gg/images/Snapthorn.png">Snapthorn</a><button class="tooltip-btn" onclick="openPopup(event,'snapthorn')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <h3 style="margin-top:8px">Blood Moon Event</h3>
        <div class="item-wrap" data-item-id="vampire-frog-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Vampire_Frog_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Vampire_Frog_Staff.png">Vampire Frog Staff</a><button class="tooltip-btn" onclick="openPopup(event,'vampire-frog-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3 style="margin-top:8px"></h3>
        <div class="item-wrap" data-item-id="finch-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Finch_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Finch_Staff.png">Finch Staff</a><button class="tooltip-btn" onclick="openPopup(event,'finch-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="abigails-flower" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Abigail%27s_Flower" target="_blank"><img src="https://terraria.wiki.gg/images/Abigail%27s_Flower.png">Abigail's Flower</a><button class="tooltip-btn" onclick="openPopup(event,'abigails-flower')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="flinx-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flinx_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Flinx_Staff.png">Flinx Staff</a><button class="tooltip-btn" onclick="openPopup(event,'flinx-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="flinx-fur-coat" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flinx_Fur_Coat" target="_blank"><img src="https://terraria.wiki.gg/images/Flinx_Fur_Coat.png">Flinx Fur Coat</a><button class="tooltip-btn" onclick="openPopup(event,'flinx-fur-coat')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a><button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
    </div>
    <div class="note">üí° Use the best armor available for Helmet and Boots.</div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê 3. Pre Queen Bee / Deerclops ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-qb-deer">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre (Queen Bee) (Deerclops)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="soulscourge" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Soulscourge" target="_blank"><img src="https://terraria.wiki.gg/images/Soulscourge.png">Soulscourge</a><button class="tooltip-btn" onclick="openPopup(event,'soulscourge')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="vasculash" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Vasculash" target="_blank"><img src="https://terraria.wiki.gg/images/Vasculash.png">Vasculash</a><button class="tooltip-btn" onclick="openPopup(event,'vasculash')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="snapthorn" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Snapthorn" target="_blank"><img src="https://terraria.wiki.gg/images/Snapthorn.png">Snapthorn</a><button class="tooltip-btn" onclick="openPopup(event,'snapthorn')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3>Meteorite Crash Site Event</h3>
        <div class="item-wrap" data-item-id="starcrash" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Starcrash" target="_blank"><img src="https://terraria.wiki.gg/images/Starcrash.png">Starcrash</a><button class="tooltip-btn" onclick="openPopup(event,'starcrash')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <div class="item-wrap" data-item-id="imp-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Imp_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Imp_Staff.png">Imp Staff</a><button class="tooltip-btn" onclick="openPopup(event,'imp-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Sentries</h3>
        <div class="item-wrap" data-item-id="flameburst-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flameburst_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Flameburst_Rod.png">Flameburst Rod</a><button class="tooltip-btn" onclick="openPopup(event,'flameburst-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="ballista-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Ballista_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Ballista_Rod.png">Ballista Rod</a><button class="tooltip-btn" onclick="openPopup(event,'ballista-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="obsidian-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Obsidian_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Obsidian_armor.png">Obsidian Armor</a><button class="tooltip-btn" onclick="openPopup(event,'obsidian-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Accessories</h3>
        <div class="item-wrap" data-item-id="apprentices-scarf" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Apprentice%27s_Scarf" target="_blank"><img src="https://terraria.wiki.gg/images/Apprentice%27s_Scarf.png">Apprentice's Scarf</a><button class="tooltip-btn" onclick="openPopup(event,'apprentices-scarf')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Buffs</h3>
        <div class="item-wrap" data-item-id="war-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/War_Table" target="_blank"><img src="https://terraria.wiki.gg/images/War_Table.png">War Table</a><button class="tooltip-btn" onclick="openPopup(event,'war-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a><button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê 4. Pre Skeletron ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-skeletron">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre (Skeletron)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="soulscourge" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Soulscourge" target="_blank"><img src="https://terraria.wiki.gg/images/Soulscourge.png">Soulscourge</a><button class="tooltip-btn" onclick="openPopup(event,'soulscourge')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="vasculash" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Vasculash" target="_blank"><img src="https://terraria.wiki.gg/images/Vasculash.png">Vasculash</a><button class="tooltip-btn" onclick="openPopup(event,'vasculash')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="snapthorn" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Snapthorn" target="_blank"><img src="https://terraria.wiki.gg/images/Snapthorn.png">Snapthorn</a><button class="tooltip-btn" onclick="openPopup(event,'snapthorn')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3>Meteorite Crash Site Event</h3>
        <div class="item-wrap" data-item-id="starcrash" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Starcrash" target="_blank"><img src="https://terraria.wiki.gg/images/Starcrash.png">Starcrash</a><button class="tooltip-btn" onclick="openPopup(event,'starcrash')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <div class="item-wrap" data-item-id="imp-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Imp_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Imp_Staff.png">Imp Staff</a><button class="tooltip-btn" onclick="openPopup(event,'imp-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Sentries</h3>
        <div class="item-wrap" data-item-id="flameburst-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flameburst_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Flameburst_Rod.png">Flameburst Rod</a><button class="tooltip-btn" onclick="openPopup(event,'flameburst-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="ballista-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Ballista_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Ballista_Rod.png">Ballista Rod</a><button class="tooltip-btn" onclick="openPopup(event,'ballista-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="bee-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Bee_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Bee_armor.png">Bee Armor</a><button class="tooltip-btn" onclick="openPopup(event,'bee-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="obsidian-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Obsidian_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Obsidian_armor.png">Obsidian Armor</a><button class="tooltip-btn" onclick="openPopup(event,'obsidian-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Accessories</h3>
        <div class="item-wrap" data-item-id="pygmy-necklace" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Pygmy_Necklace" target="_blank"><img src="https://terraria.wiki.gg/images/Pygmy_Necklace.png">Pygmy Necklace</a><button class="tooltip-btn" onclick="openPopup(event,'pygmy-necklace')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="apprentices-scarf" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Apprentice%27s_Scarf" target="_blank"><img src="https://terraria.wiki.gg/images/Apprentice%27s_Scarf.png">Apprentice's Scarf</a><button class="tooltip-btn" onclick="openPopup(event,'apprentices-scarf')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Buffs</h3>
        <div class="item-wrap" data-item-id="war-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/War_Table" target="_blank"><img src="https://terraria.wiki.gg/images/War_Table.png">War Table</a><button class="tooltip-btn" onclick="openPopup(event,'war-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a><button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê 5. Pre Wall of Flesh ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-wof">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre (Wall of Flesh)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="spinal-tap" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Spinal_Tap" target="_blank"><img src="https://terraria.wiki.gg/images/Spinal_Tap.png">Spinal Tap</a><button class="tooltip-btn" onclick="openPopup(event,'spinal-tap')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <div class="item-wrap" data-item-id="imp-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Imp_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Imp_Staff.png">Imp Staff</a><button class="tooltip-btn" onclick="openPopup(event,'imp-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Sentries</h3>
        <div class="item-wrap" data-item-id="flameburst-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flameburst_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Flameburst_Rod.png">Flameburst Rod</a><button class="tooltip-btn" onclick="openPopup(event,'flameburst-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="ballista-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Ballista_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Ballista_Rod.png">Ballista Rod</a><button class="tooltip-btn" onclick="openPopup(event,'ballista-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="bee-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Bee_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Bee_armor.png">Bee Armor</a><button class="tooltip-btn" onclick="openPopup(event,'bee-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="obsidian-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Obsidian_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Obsidian_armor.png">Obsidian Armor</a><button class="tooltip-btn" onclick="openPopup(event,'obsidian-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Accessories</h3>
        <div class="item-wrap" data-item-id="pygmy-necklace" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Pygmy_Necklace" target="_blank"><img src="https://terraria.wiki.gg/images/Pygmy_Necklace.png">Pygmy Necklace</a><button class="tooltip-btn" onclick="openPopup(event,'pygmy-necklace')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="apprentices-scarf" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Apprentice%27s_Scarf" target="_blank"><img src="https://terraria.wiki.gg/images/Apprentice%27s_Scarf.png">Apprentice's Scarf</a><button class="tooltip-btn" onclick="openPopup(event,'apprentices-scarf')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Buffs</h3>
        <div class="item-wrap" data-item-id="war-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/War_Table" target="_blank"><img src="https://terraria.wiki.gg/images/War_Table.png">War Table</a><button class="tooltip-btn" onclick="openPopup(event,'war-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="bewitching-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Bewitching_Table" target="_blank"><img src="https://terraria.wiki.gg/images/Bewitching_Table.png">Bewitching Table</a><button class="tooltip-btn" onclick="openPopup(event,'bewitching-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a><button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
    </div>
    <div class="note">üí° Health must have reached 400.</div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê 6. Pre-Mechanical Bosses ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-mech">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre-Mechanical (Mechanical Eye) (Mechanical Worm) (Mechanical Skull)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="firecracker" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Firecracker" target="_blank"><img src="https://terraria.wiki.gg/images/Firecracker.png">Firecracker</a><button class="tooltip-btn" onclick="openPopup(event,'firecracker')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="cool-whip" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Cool_Whip" target="_blank"><img src="https://terraria.wiki.gg/images/Cool_Whip.png">Cool Whip</a><button class="tooltip-btn" onclick="openPopup(event,'cool-whip')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3>After mechanical boss defeated</h3>
        <div class="item-wrap" data-item-id="durendal" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Durendal" target="_blank"><img src="https://terraria.wiki.gg/images/Durendal.png">Durendal</a><button class="tooltip-btn" onclick="openPopup(event,'durendal')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <div class="item-wrap" data-item-id="abigails-flower" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Abigail%27s_Flower" target="_blank"><img src="https://terraria.wiki.gg/images/Abigail%27s_Flower.png">Abigail's Flower</a><button class="tooltip-btn" onclick="openPopup(event,'abigails-flower')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="sanguine-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Sanguine_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Sanguine_Staff.png">Sanguine Staff</a><button class="tooltip-btn" onclick="openPopup(event,'sanguine-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="blade-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Blade_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Blade_Staff.png">Blade Staff</a><button class="tooltip-btn" onclick="openPopup(event,'blade-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Sentries</h3>
        <div class="item-wrap" data-item-id="flameburst-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flameburst_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Flameburst_Rod.png">Flameburst Rod</a><button class="tooltip-btn" onclick="openPopup(event,'flameburst-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="ballista-rod" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Ballista_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Ballista_Rod.png">Ballista Rod</a><button class="tooltip-btn" onclick="openPopup(event,'ballista-rod')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3>After 1 mech boss defeated</h3>
        <div class="item-wrap" data-item-id="flameburst-cane" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flameburst_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Flameburst_Cane.png">Flameburst Cane</a><button class="tooltip-btn" onclick="openPopup(event,'flameburst-cane')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="ballista-cane" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Ballista_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Ballista_Cane.png">Ballista Cane</a><button class="tooltip-btn" onclick="openPopup(event,'ballista-cane')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="spider-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Spider_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Spider_armor.png">Spider armor</a><button class="tooltip-btn" onclick="openPopup(event,'spider-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3>After mechanical boss defeated</h3>
        <div class="item-wrap" data-item-id="hallowed-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Hallowed_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Hallowed_armor.png">Hallowed Armor + Hood</a><button class="tooltip-btn" onclick="openPopup(event,'hallowed-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Accessories</h3>
        <div class="item-wrap" data-item-id="summoner-emblem" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoner_Emblem" target="_blank"><img src="https://terraria.wiki.gg/images/Summoner_Emblem.png">Summoner Emblem</a><button class="tooltip-btn" onclick="openPopup(event,'summoner-emblem')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="pygmy-necklace" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Pygmy_Necklace" target="_blank"><img src="https://terraria.wiki.gg/images/Pygmy_Necklace.png">Pygmy Necklace</a><button class="tooltip-btn" onclick="openPopup(event,'pygmy-necklace')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="apprentices-scarf" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Apprentice%27s_Scarf" target="_blank"><img src="https://terraria.wiki.gg/images/Apprentice%27s_Scarf.png">Apprentice's Scarf</a><button class="tooltip-btn" onclick="openPopup(event,'apprentices-scarf')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Buffs</h3>
        <div class="item-wrap" data-item-id="war-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/War_Table" target="_blank"><img src="https://terraria.wiki.gg/images/War_Table.png">War Table</a><button class="tooltip-btn" onclick="openPopup(event,'war-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="bewitching-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Bewitching_Table" target="_blank"><img src="https://terraria.wiki.gg/images/Bewitching_Table.png">Bewitching Table</a><button class="tooltip-btn" onclick="openPopup(event,'bewitching-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a><button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê 7. Pre-Plantera ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-plantera">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre-Plantera (Plantera)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="durendal" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Durendal" target="_blank"><img src="https://terraria.wiki.gg/images/Durendal.png">Durendal</a><button class="tooltip-btn" onclick="openPopup(event,'durendal')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <div class="item-wrap" data-item-id="abigails-flower" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Abigail%27s_Flower" target="_blank"><img src="https://terraria.wiki.gg/images/Abigail%27s_Flower.png">Abigail's Flower</a><button class="tooltip-btn" onclick="openPopup(event,'abigails-flower')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="sanguine-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Sanguine_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Sanguine_Staff.png">Sanguine Staff</a><button class="tooltip-btn" onclick="openPopup(event,'sanguine-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="blade-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Blade_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Blade_Staff.png">Blade Staff</a><button class="tooltip-btn" onclick="openPopup(event,'blade-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Sentries</h3>
        <div class="item-wrap" data-item-id="flameburst-cane" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flameburst_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Flameburst_Cane.png">Flameburst Cane</a><button class="tooltip-btn" onclick="openPopup(event,'flameburst-cane')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="ballista-cane" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Ballista_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Ballista_Cane.png">Ballista Cane</a><button class="tooltip-btn" onclick="openPopup(event,'ballista-cane')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="queen-spider-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Queen_Spider_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Queen_Spider_Staff.png">Queen Spider Staff</a><button class="tooltip-btn" onclick="openPopup(event,'queen-spider-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="chlorophyte-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Chlorophyte_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Chlorophyte_armor.png">Chlorophyte Armor + Visor</a><button class="tooltip-btn" onclick="openPopup(event,'chlorophyte-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Accessories</h3>
        <div class="item-wrap" data-item-id="summoner-emblem" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoner_Emblem" target="_blank"><img src="https://terraria.wiki.gg/images/Summoner_Emblem.png">Summoner Emblem</a><button class="tooltip-btn" onclick="openPopup(event,'summoner-emblem')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="pygmy-necklace" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Pygmy_Necklace" target="_blank"><img src="https://terraria.wiki.gg/images/Pygmy_Necklace.png">Pygmy Necklace</a><button class="tooltip-btn" onclick="openPopup(event,'pygmy-necklace')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="apprentices-scarf" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Apprentice%27s_Scarf" target="_blank"><img src="https://terraria.wiki.gg/images/Apprentice%27s_Scarf.png">Apprentice's Scarf</a><button class="tooltip-btn" onclick="openPopup(event,'apprentices-scarf')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Buffs</h3>
        <div class="item-wrap" data-item-id="war-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/War_Table" target="_blank"><img src="https://terraria.wiki.gg/images/War_Table.png">War Table</a><button class="tooltip-btn" onclick="openPopup(event,'war-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="bewitching-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Bewitching_Table" target="_blank"><img src="https://terraria.wiki.gg/images/Bewitching_Table.png">Bewitching Table</a><button class="tooltip-btn" onclick="openPopup(event,'bewitching-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a><button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê 8. Pre-Golem ‚ïê‚ïê‚ïê -->
<div class="stage" data-stage="stage-golem">
  <div class="stage-header" onclick="toggleStage(this)">
    <span class="stage-index"></span>
    <h2>Pre-Golem (Golem)</h2>
    <span class="done-label" style="display:none">‚úì Done</span>
    <input type="checkbox" class="stage-checkbox" onclick="event.preventDefault()">
  </div>
  <div class="stage-body">
    <div class="grid">
      <div class="section">
        <h3>Weapons</h3>
        <div class="item-wrap" data-item-id="vulgar-display-of-flower" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Vulgar_Display_of_Flower" target="_blank"><img src="https://terraria.wiki.gg/images/Vulgar_Display_of_Flower.png">Vulgar Display of Flower</a><button class="tooltip-btn" onclick="openPopup(event,'vulgar-display-of-flower')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="morning-star" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Morning_Star" target="_blank"><img src="https://terraria.wiki.gg/images/Morning_Star.png">Morning Star</a><button class="tooltip-btn" onclick="openPopup(event,'morning-star')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Minions</h3>
        <div class="item-wrap" data-item-id="blade-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Blade_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Blade_Staff.png">Blade Staff</a><button class="tooltip-btn" onclick="openPopup(event,'blade-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3>Solar Eclipse Event</h3>
        <div class="item-wrap" data-item-id="deadly-sphere-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Deadly_Sphere_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Deadly_Sphere_Staff.png">Deadly Sphere Staff</a><button class="tooltip-btn" onclick="openPopup(event,'deadly-sphere-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <h3></h3>
        <div class="item-wrap" data-item-id="desert-tiger-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Desert_Tiger_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Desert_Tiger_Staff.png">Desert Tiger Staff</a><button class="tooltip-btn" onclick="openPopup(event,'desert-tiger-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Sentries</h3>
        <div class="item-wrap" data-item-id="flameburst-cane" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Flameburst_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Flameburst_Cane.png">Flameburst Cane</a><button class="tooltip-btn" onclick="openPopup(event,'flameburst-cane')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="ballista-cane" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Ballista_sentry_summons" target="_blank"><img src="https://terraria.wiki.gg/images/Ballista_Cane.png">Ballista Cane</a><button class="tooltip-btn" onclick="openPopup(event,'ballista-cane')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="queen-spider-staff" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Queen_Spider_Staff" target="_blank"><img src="https://terraria.wiki.gg/images/Queen_Spider_Staff.png">Queen Spider Staff</a><button class="tooltip-btn" onclick="openPopup(event,'queen-spider-staff')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Armor</h3>
        <div class="item-wrap" data-item-id="chlorophyte-armor" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Chlorophyte_armor" target="_blank"><img src="https://terraria.wiki.gg/images/Chlorophyte_armor.png">Chlorophyte Armor + Visor</a><button class="tooltip-btn" onclick="openPopup(event,'chlorophyte-armor')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Accessories</h3>
        <div class="item-wrap" data-item-id="summoner-emblem" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoner_Emblem" target="_blank"><img src="https://terraria.wiki.gg/images/Summoner_Emblem.png">Summoner Emblem</a><button class="tooltip-btn" onclick="openPopup(event,'summoner-emblem')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="pygmy-necklace" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Pygmy_Necklace" target="_blank"><img src="https://terraria.wiki.gg/images/Pygmy_Necklace.png">Pygmy Necklace</a><button class="tooltip-btn" onclick="openPopup(event,'pygmy-necklace')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Buffs</h3>
        <div class="item-wrap" data-item-id="war-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/War_Table" target="_blank"><img src="https://terraria.wiki.gg/images/War_Table.png">War Table</a><button class="tooltip-btn" onclick="openPopup(event,'war-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
        <div class="item-wrap" data-item-id="bewitching-table" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Bewitching_Table" target="_blank"><img src="https://terraria.wiki.gg/images/Bewitching_Table.png">Bewitching Table</a><button class="tooltip-btn" onclick="openPopup(event,'bewitching-table')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
      <div class="section">
        <h3>Potions</h3>
        <div class="item-wrap" data-item-id="summoning-potion" data-state="none"><a class="item" href="https://terraria.wiki.gg/wiki/Summoning_Potion" target="_blank"><img src="https://terraria.wiki.gg/images/Summoning_Potion.png">Summoning Potion</a><button class="tooltip-btn" onclick="openPopup(event,'summoning-potion')">‚Ñπ</button><button class="item-btn" data-s="none" onclick="cycleItem(this)"></button></div>
      </div>
    </div>
  </div>
</div>

</div><!-- /container -->

<footer>
  <p>Data diadaptasi dari Terraria Wiki ¬∑ Class Setup Guide</p><br>
  <p>Join My Community: <a href="https://discord.gg/hSqjzEp5u7">Discord</a></p>
  <p>Github Source: <a href="https://github.com/SAMBUYYA/TerrariaClassGuideSimple">Source Page</a></p>
</footer>

<script>
// ‚ïê‚ïê‚ïê ITEM INFO DATABASE ‚ïê‚ïê‚ïê
// Format: { unlock, get, desc }
// Ganti [write on here] dengan teks kamu sendiri!
const ITEM_INFO = {
  'leather-whip': {
    unlock: '[write on here]',
    get: '[write on here]',
    desc: '[write on here]'
  },
  'vampire-frog-staff': {
    unlock: '[write on here]',
    get: '[write on here]',
    desc: '[write on here]'
  },
  'snapthorn': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'abigails-flower': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'flinx-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'flinx-fur-coat': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'summoning-potion': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'soulscourge': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'vasculash': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'finch-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'imp-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'flameburst-rod': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'ballista-rod': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'obsidian-armor': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'apprentices-scarf': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'war-table': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'starcrash': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'bee-armor': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'pygmy-necklace': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'spinal-tap': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'bewitching-table': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'firecracker': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'cool-whip': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'durendal': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'sanguine-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'blade-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'flameburst-cane': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'ballista-cane': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'spider-armor': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'hallowed-armor': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'summoner-emblem': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'queen-spider-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'chlorophyte-armor': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'vulgar-display-of-flower': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'morning-star': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'deadly-sphere-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
  'desert-tiger-staff': { unlock: '[write on here]', get: '[write on here]', desc: '[write on here]' },
};

// ‚ïê‚ïê‚ïê POPUP LOGIC ‚ïê‚ïê‚ïê
let activePopupId = null;

function getItemImg(id) {
  // Cari img src dari DOM item yang ada
  const wrap = document.querySelector(`.item-wrap[data-item-id="${id}"]`);
  if (!wrap) return '';
  const img = wrap.querySelector('.item img');
  return img ? img.src : '';
}
function getItemName(id) {
  const wrap = document.querySelector(`.item-wrap[data-item-id="${id}"]`);
  if (!wrap) return id;
  return wrap.querySelector('.item').textContent.trim();
}

function openPopup(e, id) {
  e.stopPropagation();
  const popup = document.getElementById('itemPopup');
  const info = ITEM_INFO[id] || { unlock: '‚Äî', get: '‚Äî', desc: '‚Äî' };

  document.getElementById('popupImg').src = getItemImg(id);
  document.getElementById('popupName').textContent = getItemName(id);
  document.getElementById('popupUnlock').textContent = info.unlock;
  document.getElementById('popupGet').textContent = info.get;
  document.getElementById('popupDesc').textContent = info.desc;

  // Posisi popup dekat tombol ‚Ñπ
  // position:fixed ‚Üí koordinat viewport, JANGAN tambah scrollY
  const btn = e.currentTarget;
  const rect = btn.getBoundingClientRect();
  const pw = 280;
  const ph = 300; // estimated max height
  const margin = 8;
  let left = rect.right + margin;
  let top = rect.top;

  // Jangan keluar layar kanan ‚Üí tampilkan di kiri tombol
  if (left + pw > window.innerWidth - margin) {
    left = rect.left - pw - margin;
  }
  // Jangan keluar layar kiri
  if (left < margin) left = margin;

  // Jangan keluar layar bawah
  if (top + ph > window.innerHeight - margin) {
    top = window.innerHeight - ph - margin;
  }
  // Jangan keluar layar atas
  if (top < margin) top = margin;

  popup.style.left = Math.max(margin, left) + 'px';
  popup.style.top = top + 'px';
  popup.classList.remove('visible');
  void popup.offsetWidth; // force reflow for animation
  popup.classList.add('visible');
  activePopupId = id;
}

function closePopup() {
  document.getElementById('itemPopup').classList.remove('visible');
  activePopupId = null;
}

// Klik di luar popup ‚Üí tutup
document.addEventListener('click', function(e) {
  const popup = document.getElementById('itemPopup');
  if (popup.classList.contains('visible') && !popup.contains(e.target)) {
    closePopup();
  }
});

// ‚ïê‚ïê‚ïê ITEM STATE LOGIC ‚ïê‚ïê‚ïê
const STAGE_KEY = 'terraria-summoning';
const ITEMS_KEY = 'terraria-summoning-items';
const CYCLE = ['none', 'owned', 'skip'];
let itemStates = {};

function loadItems() {
  try { itemStates = JSON.parse(localStorage.getItem(ITEMS_KEY) || '{}'); }
  catch(e) { itemStates = {}; }
}
function saveItems() { localStorage.setItem(ITEMS_KEY, JSON.stringify(itemStates)); }

function applyItemId(id) {
  const s = itemStates[id] || 'none';
  document.querySelectorAll(`.item-wrap[data-item-id="${id}"]`).forEach(w => {
    w.dataset.state = s;
    w.querySelector('.item-btn').dataset.s = s;
  });
}

function applyAll() {
  const seen = new Set();
  document.querySelectorAll('.item-wrap[data-item-id]').forEach(w => {
    const id = w.dataset.itemId;
    if (!seen.has(id)) { seen.add(id); applyItemId(id); }
  });
  updateSummary();
}

function cycleItem(btn) {
  const id = btn.closest('.item-wrap').dataset.itemId;
  const cur = itemStates[id] || 'none';
  const next = CYCLE[(CYCLE.indexOf(cur) + 1) % CYCLE.length];
  if (next === 'none') delete itemStates[id]; else itemStates[id] = next;
  saveItems();
  applyItemId(id);
  updateSummary();
}

function updateSummary() {
  let owned = 0, skip = 0;
  const names = [];
  const seen = new Set();
  document.querySelectorAll('.item-wrap[data-item-id]').forEach(w => {
    const id = w.dataset.itemId;
    if (seen.has(id)) return;
    seen.add(id);
    const s = itemStates[id];
    if (s === 'owned') { owned++; names.push(w.querySelector('.item').textContent.trim()); }
    if (s === 'skip') skip++;
  });
  document.getElementById('ownedCount').textContent = owned;
  document.getElementById('skipCount').textContent = skip;
  const el = document.getElementById('ownedNames');
  if (owned === 0 && skip === 0) el.textContent = '‚Äî no items marked yet';
  else el.textContent = owned > 0 ? '‚úì ' + names.join(', ') : (skip > 0 ? skip + ' item di-skip' : '');
}

// ‚ïê‚ïê‚ïê RESET ALL (item + stage) ‚ïê‚ïê‚ïê
function resetAll() {
  // Reset items
  itemStates = {};
  saveItems();
  applyAll();
  // Reset stages
  localStorage.removeItem(STAGE_KEY);
  loadStages();
  // Tutup popup kalau terbuka
  closePopup();
}

// ‚ïê‚ïê‚ïê STAGE LOGIC ‚ïê‚ïê‚ïê
function stages() { return Array.from(document.querySelectorAll('div.stage')); }

function saveStages() {
  localStorage.setItem(STAGE_KEY, JSON.stringify(stages().map(s => s.classList.contains('done'))));
  renderProgress();
}

function loadStages() {
  stages().forEach((s, i) => { s.querySelector('.stage-index').textContent = i + 1; });
  let data = [];
  try { data = JSON.parse(localStorage.getItem(STAGE_KEY) || '[]'); } catch(e) {}
  stages().forEach((s, i) => {
    const b = s.querySelector('.stage-body');
    b.style.transition = 'none';
    if (data[i] === true) {
      s.classList.add('done');
      b.style.maxHeight = '0';
      b.style.opacity = '0';
      s.querySelector('.done-label').style.display = 'inline';
      s.querySelector('.stage-checkbox').checked = true;
    } else {
      s.classList.remove('done');
      b.style.maxHeight = '2000px';
      b.style.opacity = '1';
      s.querySelector('.done-label').style.display = 'none';
      s.querySelector('.stage-checkbox').checked = false;
    }
    setTimeout(() => { b.style.transition = ''; }, 100);
  });
  renderProgress();
}

function toggleStage(h) {
  const s = h.closest('div.stage'), b = s.querySelector('.stage-body');
  const nd = !s.classList.contains('done');
  if (nd) {
    s.classList.add('done');
    b.style.maxHeight = '0'; b.style.opacity = '0';
    s.querySelector('.done-label').style.display = 'inline';
    s.querySelector('.stage-checkbox').checked = true;
  } else {
    s.classList.remove('done');
    b.style.maxHeight = '2000px'; b.style.opacity = '1';
    s.querySelector('.done-label').style.display = 'none';
    s.querySelector('.stage-checkbox').checked = false;
  }
  saveStages();
}

function renderProgress() {
  const all = stages();
  const done = all.map((s, i) => s.classList.contains('done') ? i + 1 : null).filter(Boolean);
  let t = `${done.length} / ${all.length} completed`;
  if (done.length) t += ` ¬∑ Stage ${done.join(', ')}`;
  document.getElementById('progressText').textContent = t;
}

window.addEventListener('DOMContentLoaded', () => {
  loadItems();
  loadStages();
  applyAll();
});
</script>
</body>
</html>
